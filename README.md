# Twenty Twenty-One Child Theme

Дочерняя тема для WordPress на основе Twenty Twenty-One.  
Предназначена для проектов с кастомным типом записи `project`, поддержкой сетки проектов, фильтров и галереи на отдельных страницах.

---
## Установка
1. Установите WordPress v.6.9.
1. Установите плагин ACF (бесплатная версия) и тему TwentyTwentyOne из магазина тем.
1. Загрузите файлы этого проекта в "/wp-content/themes/"
1. Активируйте тему
1. В ACF сделайте импорт полей из файла "acf-export-2025-12-04.json"

## Структура проекта

twentytwentyone-child
├── assets
│   ├── css
│   │   └── responsive.css
│   └── js
│       ├── project-gallery.js
│       └── projects-filter.js
├── functions.php
├── inc
│   ├── ajax-handlers.php
│   ├── enqueue.php
│   ├── helpers.php
│   ├── lib
│   │   └── embla-carousel.umd.js
│   └── post-types.php
├── page-projects.php
├── README.md
├── single-project.php
├── style.css
└── template-parts
    └── content-project.php

---

## Описание файлов и папок

### Корень темы
- **`style.css`** — основной CSS дочерней темы. Содержит базовые стили и CSS-переменные.  
- **`functions.php`** — основной файл функций темы. Подключает вспомогательные файлы из `inc/`.  
- **`README.md`** — документация темы и описание структуры проекта.  

### Папка `assets`
- **`css/responsive.css`** — медиазапросы и адаптивные стили для разных устройств (desktop, tablet, mobile).  
- **`js/project-gallery.js`** — скрипт для работы галереи проекта (Embla слайдер и Lightbox2).  
- **`js/projects-filter.js`** — скрипт для фильтрации и сортировки проектов на странице всех проектов (AJAX).  

### Папка `inc`
- **`ajax-handlers.php`** — обработка AJAX-запросов.  
- **`enqueue.php`** — подключение всех CSS и JS файлов дочерней темы и сторонних библиотек.  
- **`helpers.php`** — вспомогательные функции для работы с ACF и проектами.
- **`lib/embla-carousel.umd.js`** — локальная библиотека Embla для слайдера.  
- **`post-types.php`** — регистрация кастомного типа записи `project` и таксономии `project_category`.  

### Шаблоны
- **`page-projects.php`** — кастомная страница WordPress для отображения всех проектов в сетке с фильтром и сортировкой.  
- **`single-project.php`** — шаблон отдельного проекта, вывод контента, галереи, описания и метаданных.  
- **`template-parts/content-project.php`** — частичный шаблон карточки проекта, используется на странице проектов.

### Используемые библиотеки
- **`Embla Carousel`**
- **`Lightbox2`**

---

## Особенности
- Используются CSS-переменные для быстрой кастомизации стилей и цветов.  
- Адаптивная сетка проектов и слайдер Embla для галереи вместе с Lightbox2.  
- Встроенные хелперы для работы с данными: форматирование цены, вывод категорий.  
- AJAX-фильтр проектов на странице всех проектов.

---

## Примечания
- Для реализации галереи без ACF Pro было принято решение имитировать галерею через поле типа Group и четырёх входящих в него полей Image со слагами вида "image_номер", чтобы было проще проходить циклом по группе независимо от того, сколько таких изображений находится в группе, и для предсказуемого namespace.
- В галерее используется слайдер Embla: лёгкий и простой для текущего случая в настройке, и Lightbox2 для открытия изображений в полноразмерном формате по клику.
- Тип поста `projects` и его таксономия `project_category` должны будут работать сразу же при подключении, термины таксономии заранее прописаны.
- `functions.php` был логически разделён по файлам в `/inc` для удобства поддержки и расширения, как это происходило бы на реальном проекте.
-  В техническом задании указаны брейкпойнты, которые не покрывают ширину от 992px до 1399px. Делаю вывод, что здесь предполагалась либо mobile-first разработка, либо была допущена опечатка в desktop брейкпойнте. Выполнил медиа-запросы по первому предположению с дополнением для непокрытой ширины.

## AJAX
### На странице всех проектов реализован динамический фильтр и сортировка без перезагрузки страницы.
- Когда пользователь выбирает вариант сортировки в `<select> (#projects-sort)`, JavaScript (`projects-filter.js`) формирует AJAX-запрос к `admin-ajax.php`, передавая действие `filter_projects` и выбранный параметр сортировки.
- На серверной стороне `ajax-handlers.php` ловит запрос через хуки `wp_ajax_filter_projects` и `wp_ajax_nopriv_filter_projects`, собирает `WP_Query` для типа `project` с нужной сортировкой (по дате или цене, по возрастанию или убыванию), прогоняет цикл `while ($projects->have_posts())` с подключением шаблона `content-project.php`, собирает HTML через буферизацию `ob_start()` и возвращает результат JSON-ответом.
- JS получает ответ, и через innerHTML обновляет контейнер с карточками, оставляя неизменными заголовки и обертку страницы, что обеспечивает плавное обновление контента без полной перезагрузки.


